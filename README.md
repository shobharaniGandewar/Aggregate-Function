# Aggregate-Function

CREATE TABLE sales (
sale_id INT AUTO_INCREMENT PRIMARY KEY,
product_name VARCHAR(255),
category VARCHAR(100),
quantity INT,
price_per_unit DECIMAL(10, 2),
sale_date DATE
);
INSERT INTO sales (product_name, category, quantity, price_per_unit,
sale_date) VALUES
('Laptop', 'Electronics', 3, 500.00, '2024-08-01'),
('Headphones', 'Electronics', 10, 30.00, '2024-08-01'),
('Desk Chair', 'Furniture', 2, 120.00, '2024-08-02'),
('Monitor', 'Electronics', 4, 200.00, '2024-08-03'),
('Couch', 'Furniture', 1, 700.00, '2024-08-04'),
('Laptop', 'Electronics', 2, 550.00, '2024-08-05'),
('Desk Lamp', 'Furniture', 5, 40.00, '2024-08-06'),
('Keyboard', 'Electronics', 6, 45.00, '2024-08-07');
Practical Questions
1. Total Quantity of Products Sold:
Question: Write a query to find the total quantity of all products sold.
Answer:
SELECT SUM(quantity) AS total_quantity_sold FROM sales;
2. Total Sales Amount:
Question: Calculate the total sales amount (quantity * price_per_unit) for all
products.
Answer:
SELECT SUM(quantity * price_per_unit)
AS
Total_sales_amount FROM sales;
3. Average Price per Unit by Category:
Question: Find the average price per unit for each product category.
Answer:
SELECT category, AVG(price_per_unit)
AS average_price FROM sales GROUP BY category;
4. Maximum and Minimum Sale Price:
Question: Determine the maximum and minimum sale price for any single sale
transaction.
Answer:
SELECT MAX(quantity * price_per_unit)
AS max_sale_price,
MIN(quantity * price_per_unit) AS min_sale_price FROM sales;
5. Count of Different Products Sold:
Question: Write a query to count the number of different products sold.
Answer:
SELECT COUNT(DISTINCT product_name)
AS different_products_sold FROM sales;
6. Sales by Day:
Question: Find the total sales amount for each day.
Answer:
SELECT sale_date, SUM(quantity * price_per_unit)
AS daily_sales FROM sales GROUP BY sale_date;
7. Number of Sales per Category:
Question: Get the number of sales made for each product category.
Answer:
SELECT category, COUNT(*) AS sales_count FROM sales
GROUP BY category;
8. Average Quantity Sold per Day:
Question: Find the average quantity of products sold per day.
Answer:
SELECT sale_date, AVG(quantity) AS average_quantity
FROM sales GROUP BY sale_date;
9. Most Expensive Product Sold:
Question: Identify the product with the highest price per unit.
Answer:
SELECT product_name, MAX(price_per_unit) AS highest_price
FROM sales;
10. Total Sales for Each Product:
Question: Calculate the total sales amount for each product (quantity *
price_per_unit).
Answer:
SELECT product_name, SUM(quantity * price_per_unit)
AS total_sales FROM sales GROUP BY product_name;
11. Find the Day with the Highest Sales:
Question: Determine the day on which the highest total sales were made.
Answer:
SELECT sale_date, SUM(quantity * price_per_unit)
AS total_sales
FROM sales
GROUP BY sale_date
ORDER BY total_sales DESC
LIMIT 1;
12. Average Sales Amount per Transaction:
Question: Calculate the average sales amount for each transaction.
Answer:
SELECT AVG(quantity * price_per_unit)
AS average_transaction_amount FROM sales;
13. Category with the Most Sales:
Question: Find the category with the most total sales in terms of quantity.
Answer:
SELECT category, SUM(quantity) AS total_quantity
FROM sales
GROUP BY category
ORDER BY total_quantity DESC
LIMIT 1;
14. Count of Sales Greater Than a Specific Amount:
Question: How many sales transactions had a total amount greater than $500?
Answer:
SELECT COUNT(*) AS high_value_sales
FROM sales
WHERE quantity * price_per_unit > 500;
15. Top 3 Products by Sales Amount:
Question: List the top 3 products by total sales amount.
Answer:
SELECT product_name, SUM(quantity * price_per_unit)
AS total_sales
FROM sales
GROUP BY product_name
ORDER BY total_sales DESC
LIMIT 3;
Bonus Questions
16. Calculate the Total Number of Transactions:
Question: How many transactions are there in total?
Answer:
SELECT COUNT(*) AS total_transactions FROM sales;
17. Find the Most Frequently Sold Product:
Question: Which product was sold the most frequently?
Answer:
SELECT product_name, COUNT(*) AS frequency
FROM sales
GROUP BY product_name
ORDER BY frequency DESC
LIMIT 1;
18. Total Revenue per Category:
Question: Calculate the total revenue generated by each product category.
Answer:
SELECT category, SUM(quantity * price_per_unit)
AS total_revenue
FROM sales
GROUP BY category;
19. Average Price for Products Sold in a Specific Date Range:
Question: Find the average price per unit for products sold between '2024-08-01'
and '2024-08-05'.
Answer:
SELECT AVG(price_per_unit) AS average_price
FROM sales
WHERE sale_date BETWEEN '2024-08-01' AND '2024-08-05';
20. Determine Products with No Sales:
Question: Identify products that have not been sold at all (assuming we have
another table products listing all available products).
Answer:
SELECT p.product_name
FROM products p
LEFT JOIN sales s ON p.product_name = s.product_name
WHERE s.product_name IS NULL;
